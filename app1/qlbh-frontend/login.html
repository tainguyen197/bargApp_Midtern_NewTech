<!DOCTYPE html>
<html>

<head>
    <title>Long-Polling</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>

<body>
    <form name="frm">
        <div class="col-sm-4"></div>
        <div class="col-sm-4">
            <span id="note"></span>
            <div class="form-group"><label for="usr">Tài khoảng:</label><input class="form-control"  type="text" name="id" placeholder="Tài khoảng"></div>
            <div class="form-group"><label for="usr">Mật khẩu:</label><input class="form-control" name="password" type="password" placeholder="Mật khẩu"></div>
            <input type="button" class="btn btn-primary" value="Đăng nhập" onclick="DangNhap(this.form)">

        </div>
    </form>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script type="text/javascript">
		function DangNhap(frm){
            
            console.log(window.sessionStorage.accessToken);
			var instance = axios.create({
                baseURL: 'http://localhost:3000/login',
                headers: {
                     'Authorization': 'Bearer ' + window.sessionStorage.accessToken
                },
				timeout: 15000
			});
			instance.post('?id=' + frm.id.value + '&password=' + frm.password.value)
				.then(function (res) {
                
					if (res.status === 200) {
						window.sessionStorage.accessToken = res.data.token;
                    }
				}).catch(function (err) {
                        document.getElementById("note").innerHTML = err.response.data
                })
        }
	</script>
</body>

</html>